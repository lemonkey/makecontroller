<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<LINK href="doxygen.css" />
<title>MAKE Controller Kit</title>
<link href="mt_doxygen.css" rel="stylesheet" type="text/css" />
<link href="../resources/mt_doxytabs.css" rel="stylesheet" type="text/css" />
</head>

<body>
<div align="left">
  <table width="95%" border="0">
    <tr>
      <td><div align="center"><a href="http://www.makingthings.com"><img src="../resources/logo_brown_medium.png" alt="MakingThings" width="200" height="78" border="0" align="middle" longdesc="http://www.makingthings.com" /></a></div></td>
      <td><div align="center"><font size="6">MAKE Controller Kit</font></div></td>
      <td><div align="center"><a href="http://www.makezine.com"><img src="../resources/make_logo.png" alt="MAKE Zine" width="164" height="73" border="0" align="middle" longdesc="http://www.makezine.com" /></a></div></td>
    </tr>
  </table>
<span class="style2"><a href="http://www.makingthings.com"></a></span></div>
</body>
</html>
<!-- Generated by Doxygen 1.4.6-NO -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1>Eeprom<br>
<small>
[<a class="el" href="group___controller.html">Controller</a>]</small>
</h1>Eeprom allows for the persistent storage of 32k bytes data.  
<a href="#_details">More...</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g400b34091bd189fb89377c406e9f6de8"></a><!-- doxytag: member="Eeprom::EEPROM_RESERVE_SIZE" ref="g400b34091bd189fb89377c406e9f6de8" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#g400b34091bd189fb89377c406e9f6de8">EEPROM_RESERVE_SIZE</a>&nbsp;&nbsp;&nbsp;1024</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the amount of the EEPROM reserved for system information. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ge3ef7bba113f663df6996f286b632a3f"></a><!-- doxytag: member="Eeprom::EEPROM_SIZE" ref="ge3ef7bba113f663df6996f286b632a3f" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#ge3ef7bba113f663df6996f286b632a3f">EEPROM_SIZE</a>&nbsp;&nbsp;&nbsp;( 32 * 1024 )</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The size of the EEPROM on the MAKE Controller Board. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g21f0aea7664956772b1b069508e92023"></a><!-- doxytag: member="Eeprom::EEPROM_SYSTEM_BASE" ref="g21f0aea7664956772b1b069508e92023" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#g21f0aea7664956772b1b069508e92023">EEPROM_SYSTEM_BASE</a>&nbsp;&nbsp;&nbsp;( EEPROM_SIZE - EEPROM_RESERVE_SIZE )</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The location in Eeprom that the "System" information begins. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ga5b31848d128076c60ec4408fd2b1381"></a><!-- doxytag: member="Eeprom::EEPROM_SYSTEM_SERIAL_NUMBER" ref="ga5b31848d128076c60ec4408fd2b1381" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#ga5b31848d128076c60ec4408fd2b1381">EEPROM_SYSTEM_SERIAL_NUMBER</a>&nbsp;&nbsp;&nbsp;EEPROM_SYSTEM_BASE + 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The location in Eeprom where the Controller's serial number is stored. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g63beea28522912cf31cb59c101e2edab"></a><!-- doxytag: member="Eeprom::EEPROM_SYSTEM_NET_CHECK" ref="g63beea28522912cf31cb59c101e2edab" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#g63beea28522912cf31cb59c101e2edab">EEPROM_SYSTEM_NET_CHECK</a>&nbsp;&nbsp;&nbsp;EEPROM_SYSTEM_BASE + 8</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The location in Eeprom of the checksum that validates the IP settings. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gec1ef3501e18c973e4b508318b44bed3"></a><!-- doxytag: member="Eeprom::EEPROM_SYSTEM_NET_ADDRESS" ref="gec1ef3501e18c973e4b508318b44bed3" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#gec1ef3501e18c973e4b508318b44bed3">EEPROM_SYSTEM_NET_ADDRESS</a>&nbsp;&nbsp;&nbsp;EEPROM_SYSTEM_BASE + 12</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The location in Eeprom of the Controller's IP address. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g20ae88c38975023d93ff7b68022b74f4"></a><!-- doxytag: member="Eeprom::EEPROM_SYSTEM_NET_MASK" ref="g20ae88c38975023d93ff7b68022b74f4" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#g20ae88c38975023d93ff7b68022b74f4">EEPROM_SYSTEM_NET_MASK</a>&nbsp;&nbsp;&nbsp;EEPROM_SYSTEM_BASE + 16</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The location in Eeprom where the IP address mask is stored. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g9283a1abf7b98ca1b788ca350eea74f2"></a><!-- doxytag: member="Eeprom::EEPROM_SYSTEM_NET_GATEWAY" ref="g9283a1abf7b98ca1b788ca350eea74f2" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#g9283a1abf7b98ca1b788ca350eea74f2">EEPROM_SYSTEM_NET_GATEWAY</a>&nbsp;&nbsp;&nbsp;EEPROM_SYSTEM_BASE + 20</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The location in Eeprom where the IP address of the gateway is stored. <br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#g0f3449ca4a5f092e3cdf605799d14fc6">Eeprom_SetActive</a> (int state)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the active state of the EEPROM subsystem.  <a href="#g0f3449ca4a5f092e3cdf605799d14fc6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#g04eebd476f28804ef10866f692a78f4f">Eeprom_GetActive</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read the active state of the EEPROM.  <a href="#g04eebd476f28804ef10866f692a78f4f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#g03d8b089bb0d04209e032ea233218d3a">Eeprom_Write</a> (int address, uchar *buffer, int count)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write data to the EEPROM.  <a href="#g03d8b089bb0d04209e032ea233218d3a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#g95bd921a774026d4cc96b20d6a20d9dd">Eeprom_Read</a> (int address, uchar *buffer, int count)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read data from the EEPROM.  <a href="#g95bd921a774026d4cc96b20d6a20d9dd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___eeprom.html#g0d984a59a03896a61603790ba16dbbad">Eeprom_GetLastAddress</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the last usable address in the EEPROM.  <a href="#g0d984a59a03896a61603790ba16dbbad"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Eeprom allows for the persistent storage of 32k bytes data. 
<p>
The last 1k (1024) bytes of this space are reserved for system use storing things like the board's IP address, serial number, build version, etc.<p>
Eeprom is activated by the first use of the <a class="el" href="group___eeprom.html#g03d8b089bb0d04209e032ea233218d3a">Eeprom_Write()</a> or <a class="el" href="group___eeprom.html#g95bd921a774026d4cc96b20d6a20d9dd">Eeprom_Read()</a> functions. Whether its running or not can be determined by calling the <a class="el" href="group___eeprom.html#g04eebd476f28804ef10866f692a78f4f">Eeprom_GetActive()</a> function. It can be turned off by calling <a class="el" href="group___eeprom.html#g0f3449ca4a5f092e3cdf605799d14fc6">Eeprom_SetActive( )</a> passing in false or 0.<p>
Internally, Eeprom relies on <a class="el" href="group___spi.html">Spi</a>, so activating Eeprom also activates <a class="el" href="group___spi.html">Spi</a>. <hr><h2>Function Documentation</h2>
<a class="anchor" name="g04eebd476f28804ef10866f692a78f4f"></a><!-- doxytag: member="eeprom.c::Eeprom_GetActive" ref="g04eebd476f28804ef10866f692a78f4f" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Eeprom_GetActive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read the active state of the EEPROM. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>State - 1/non-zero (on) or 0 (off). </dd></dl>

<p>
Definition at line <a class="el" href="eeprom_8c-source.html#l00094">94</a> of file <a class="el" href="eeprom_8c-source.html">eeprom.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="g0d984a59a03896a61603790ba16dbbad"></a><!-- doxytag: member="eeprom.c::Eeprom_GetLastAddress" ref="g0d984a59a03896a61603790ba16dbbad" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Eeprom_GetLastAddress           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the last usable address in the EEPROM. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>none</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>address </dd></dl>

<p>
Definition at line <a class="el" href="eeprom_8c-source.html#l00192">192</a> of file <a class="el" href="eeprom_8c-source.html">eeprom.c</a>.
<p>
References <a class="el" href="eeprom_8h-source.html#l00070">EEPROM_RESERVE_SIZE</a>, and <a class="el" href="eeprom_8h-source.html#l00071">EEPROM_SIZE</a>.    </td>
  </tr>
</table>
<a class="anchor" name="g95bd921a774026d4cc96b20d6a20d9dd"></a><!-- doxytag: member="eeprom.c::Eeprom_Read" ref="g95bd921a774026d4cc96b20d6a20d9dd" args="(int address, uchar *buffer, int count)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Eeprom_Read           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uchar *&nbsp;</td>
          <td class="mdname" nowrap> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read data from the EEPROM. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>An integer specifying the address to read from. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>A pointer to the buffer to read into. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>An integer specifying the number of bytes to read. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>status. </dd></dl>

<p>
Definition at line <a class="el" href="eeprom_8c-source.html#l00151">151</a> of file <a class="el" href="eeprom_8c-source.html">eeprom.c</a>.
<p>
References <a class="el" href="eeprom_8c-source.html#l00048">EEPROM_DEVICE</a>, <a class="el" href="eeprom_8c-source.html#l00045">EEPROM_INSTRUCTION_READ</a>, <a class="el" href="eeprom_8h-source.html#l00071">EEPROM_SIZE</a>, <a class="el" href="spi_8c-source.html#l00193">Spi_Lock()</a>, and <a class="el" href="spi_8c-source.html#l00144">Spi_ReadWriteBlock()</a>.
<p>
Referenced by <a class="el" href="poly_8c-source.html#l00511">Follower_Init()</a>, <a class="el" href="network_8c-source.html#l00282">Network_GetAddress()</a>, <a class="el" href="network_8c-source.html#l00354">Network_GetGateway()</a>, <a class="el" href="network_8c-source.html#l00318">Network_GetMask()</a>, <a class="el" href="network_8c-source.html#l00246">Network_GetValid()</a>, <a class="el" href="network_8c-source.html#l00213">Network_SetValid()</a>, <a class="el" href="poly_8c-source.html#l00684">Oscillator_Init()</a>, <a class="el" href="system_8c-source.html#l00085">System_GetSerialNumber()</a>, and <a class="el" href="poly_8c-source.html#l00308">Timer_Init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="g0f3449ca4a5f092e3cdf605799d14fc6"></a><!-- doxytag: member="eeprom.c::Eeprom_SetActive" ref="g0f3449ca4a5f092e3cdf605799d14fc6" args="(int state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Eeprom_SetActive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>state</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the active state of the EEPROM subsystem. 
<p>
This is automatically set to true by any call to Eeprom_Write or Eeprom_Read. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>state</em>&nbsp;</td><td>An integer specifying the active state - 1 (on) or 0 (off). </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>CONTROLLER_OK (=0) on success. </dd></dl>

<p>
Definition at line <a class="el" href="eeprom_8c-source.html#l00082">82</a> of file <a class="el" href="eeprom_8c-source.html">eeprom.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="g03d8b089bb0d04209e032ea233218d3a"></a><!-- doxytag: member="eeprom.c::Eeprom_Write" ref="g03d8b089bb0d04209e032ea233218d3a" args="(int address, uchar *buffer, int count)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Eeprom_Write           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uchar *&nbsp;</td>
          <td class="mdname" nowrap> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write data to the EEPROM. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>An integer specifying the address. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>A pointer to the buffer to write from. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>An integer specifying the number of bytes to write. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>status. </dd></dl>

<p>
Definition at line <a class="el" href="eeprom_8c-source.html#l00106">106</a> of file <a class="el" href="eeprom_8c-source.html">eeprom.c</a>.
<p>
References <a class="el" href="eeprom_8c-source.html#l00046">EEPROM_INSTRUCTION_WRITE</a>, <a class="el" href="eeprom_8h-source.html#l00071">EEPROM_SIZE</a>, and <a class="el" href="spi_8c-source.html#l00193">Spi_Lock()</a>.
<p>
Referenced by <a class="el" href="poly_8c-source.html#l00664">Follower_SaveConstants()</a>, <a class="el" href="network_8c-source.html#l00134">Network_SetAddress()</a>, <a class="el" href="network_8c-source.html#l00190">Network_SetGateway()</a>, <a class="el" href="network_8c-source.html#l00163">Network_SetMask()</a>, <a class="el" href="network_8c-source.html#l00213">Network_SetValid()</a>, <a class="el" href="poly_8c-source.html#l00833">Oscillator_SaveConstants()</a>, <a class="el" href="system_8c-source.html#l00100">System_SetSerialNumber()</a>, and <a class="el" href="poly_8c-source.html#l00499">Timer_SaveConstants()</a>.    </td>
  </tr>
</table>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>MAKE Controller Kit</title>
</head>

<body>
<hr size="1">
<div align="left"><font size="2">Last revision: 22 Sep 2006. MAKE Controller Kit, by </font><a href="http://www.makingthings.com"><img src="../resources/logo_brown_small.png" alt="MakingThings" width="100" height="40" border="0" align="middle" longdesc="MakingThings" /></a></div>
</body>
</html>
